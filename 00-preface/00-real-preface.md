# 自序

一直想写一本数据库的新书，只是近些年做的事情太杂了，时而开源，时而国产化，时而超融合，时而云平台。东一锤子，西一榔头的，所以也很难专心写一本书。还好2019年开始开了一个“白鳝的洞穴”的公众号，于是陆陆续续写了一些文章。从最初每篇文章大几百字到现在每篇两三千字，这些年也写了近七百篇技术文章了，积累了好几十万字的素材了。最近我翻看了一些文章，发现里面大多数和数据库有关，覆盖了数据库原理到运维优化的很多方面。如果要把这些文章收集成册出版的话，还是有点杂乱的。不过如果加以整理，我发现这些年在公众号里探讨的问题还都挺有价值的，虽然是一家之言，不过对于想学习和了解数据库的DBA、架构师以及数据库产业的研发人员，产品经理来说，还是有一些价值的。从一个用了几十年数据库的DBA、曾经的程序员和架构师的角度看数据库的问题，在某些方面可能会更有助于思考。

某一天突然有个念头，如果把这些文章整理编撰一下，出一本《数据库杂谈》的书。于是我就开始每天整理一点，开始梳理这些文章，对于讲的不够清晰的，就加以补充，对于重复的加以剔除。再补上一些实战案例，可读性也还不错。只是不知道这样的书是不是有出版社愿意出版，读者受众是否接受这样的读物。当年我写《ORACLE DBA优化日记》的时候，感觉当时没有能力写一本关于Oracle数据库优化的系统性的书籍，因此只好以一个优化案例为主线，写出一些在数据库优化方面的实战经验。当时好像市面上也没有类似的数据库著作，不过这本当时比较异类的书的市场反应不错，之后类似作品也变得热了起来，DBA们也纷纷开始分享自己的​工作经验。

数据库是一个十分庞大的体系，特别是想把数据库的方方面面都讲的很清楚的书，往往都过于简单和浅显，很多​时候看了不够过瘾，也不足以引发一些思考。​在微信公众号上的文章都是我平时在思考的问题，每天早上把我的认知整理一下，写一篇文章。经过一段时间，有些思考已经更加成熟了，此时​也需要整理一下。在整理的过程中，顺便编著成册，​也是一件美事。

因为谈的内容比较杂，也很难按照数据库技术形成一本体系完整的技术类书籍，因此只能叫作“杂谈”。其内容虽杂，不过观点是相对一贯的。虽然我没有从事过数据库产品的研发工作，不过这些年见过用过的数据库产品还是挺多的。做过的大量优化项目也让我对数据库产品在功能，性能、可靠性等方面的认知也还算丰富。因此我把本书的第一章设定为“数据库原理”。一个外行人杂谈技术，也许会比内行人有不同的视角。这些年我写了一些数据库的缺点弱点，也经常有数据库产业的从业人员与我交流，大多数还是比较认同我的观点的，不过也有一些朋友持不同意见。大家讨论或者争论也是难免，通过争论，大家都有所裨益。我从用户的角度，从优化的角度去看一个数据库的缺点，往往是数据库研发人员不太容易看到的。

数据库与硬件，与操作系统的关系十分密切，所有搞数据库的人都明白。但是数据库与操作系统的关系，我们更关注哪些方面，有哪些更为深入的联系。现代硬件仅仅是数据库产品的载体与运行环境吗？还是应该成为数据库的一部分呢？数据库产品研发人员只有深入理解现代硬件，才能掌握数据库如何更好的榨干硬件的每一分价值，从而创造出更高性能，更具有性价比的数据库产品来。

这些年在数据库领域探讨的问题太多，所以本书的内容可能会比较杂乱，不过杂乱也有杂乱的好处，那就是可读性比传统的技术类书籍要好。杂就很难很深，因此本书讨论的问题不会特别深入，大多数是点到即止。对于想深入了解相关技术的朋友，可能会觉得不够过瘾。不过也没关系，开卷必然有益，因为这些“杂文”里面包含了我们团队这二十年来的一些积累。《数据库杂谈》不是我一个人对数据库原理、数据库优化、数据库运维、数据库安全、DBA生涯的领悟与理解，同时也包含了大量数据库从业人员、IT主管、数据库用户对这些方面的群体理解，正是我和他们的不断碰撞与交流，让我对数据库技术，数据库应用有了更深层次的理解。这本书也包含了基石数据数据库团队的一些思考与实践。套用一句俗话，这本书实际上是群体智慧的结晶，是这些年群体实践的产出物。

# Preface

I have always wanted to write a new book on databases, but the things I have done in recent years have been too complicated, sometimes open source, sometimes localized, sometimes hyper-converged, and sometimes cloud platforms. There is a hammer in one place and a hammer in the other, so it is difficult to concentrate on writing a book. Fortunately, a public account for "Eel's Cave" was opened in 2019, so I wrote some articles one after another. From the beginning, each article was a few hundred words long to now each article is two to three thousand words. Over the years, I have written nearly 700 technical articles, and accumulated hundreds of thousands of words of material. Recently I read some articles and found that most of them are related to databases, covering many aspects from database principles to operation and maintenance optimization. If these articles were to be collected and published in a volume, it would still be a bit messy. However, if I sort it out, I find that the issues discussed in the public account over the years are quite valuable. Although it is a personal opinion, it is for DBAs, architects, and R&D personnel and product managers in the database industry who want to learn and understand databases. , still has some value. Looking at database issues from the perspective of a DBA, former programmer, and architect who has used databases for decades may be more helpful in some aspects.

One day I suddenly had the idea to compile these articles and publish a book called "Database Miscellany". So I began to organize a little bit every day and began to sort out these articles. If the explanations were not clear enough, I would add them and eliminate the duplicates. After adding some practical cases, the readability is not bad. I just don’t know if any publishing house is willing to publish such a book, and whether readers will accept such a book. When I wrote "ORACLE DBA Optimization Diary", I felt that I was not capable of writing a systematic book on Oracle database optimization, so I had to use an optimization case as the main line to write down some practical experience in database optimization. It seemed that there were no similar database books on the market at that time, but the market response to this unusual book at the time was good. Later, similar works became popular, and DBAs began to share their work experiences.

The database is a very large system, especially books that want to explain all aspects of the database clearly, but they are often too simple and superficial. In many cases, they are not enjoyable enough to read, and they are not enough to trigger some thinking. The articles on the WeChat official account are all issues I usually think about. I sort out my knowledge and write an article every morning. After a period of time, some thoughts have become more mature and need to be sorted out at this time. In the process of organizing, it is also a beautiful thing to compile it into a book.

Because the content of the talk is relatively complex, it is difficult to form a complete technical book based on database technology, so it can only be called "miscellaneous talk". Although its content is complex, its views are relatively consistent. Although I have never been engaged in the research and development of database products, I have seen and used quite a few database products over the years. The large number of optimization projects I have done have also given me a rich understanding of the functions, performance, reliability, etc. of database products. Therefore, I set the first chapter of this book to "Database Principles". A layman talking about technology may have a different perspective than an insider. Over the years, I have written about some shortcomings and weaknesses of databases, and practitioners in the database industry have often communicated with me. Most of them agree with my views, but there are also some friends who hold different opinions. It is inevitable for everyone to discuss or argue. Through debate, everyone will benefit. I look at the shortcomings of a database from the perspective of users and optimization, which are often not easily seen by database developers.

The relationship between databases, hardware, and operating systems is very close, and everyone who works in databases understands this. But what aspects of the relationship between databases and operating systems do we pay more attention to, and what are the deeper connections. Is modern hardware just the carrier and operating environment for database products? Or should it be part of the database? Only by in-depth understanding of modern hardware can database product developers master how the database can better squeeze out every ounce of value from the hardware, thereby creating higher-performance, more cost-effective database products.

There have been too many issues discussed in the database field in recent years, so the content of this book may be relatively messy, but messiness also has the advantage of being messy, that is, the readability is better than traditional technical books. It is difficult to be very complex, so the issues discussed in this book will not be particularly in-depth, and most of them will just hit the mark. For those who want to learn more about related technologies, it may not be enjoyable enough. But it doesn’t matter, opening the book will definitely be beneficial, because these “essays” contain some of the accumulation of our team over the past twenty years. "Database Talk" is not just my own understanding of database principles, database optimization, database operation and maintenance, database security, and DBA career. It also contains the collective understanding of these aspects by a large number of database practitioners, IT directors, and database users. It was my constant collisions and exchanges with them that gave me a deeper understanding of database technology and database applications. This book also contains some thoughts and practices of the Cornerstone Data database team. To paraphrase a common saying, this book is actually the crystallization of group wisdom and the output of group practice over the years.
